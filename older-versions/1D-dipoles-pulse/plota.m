clear all,close all
matrix=load('amp-matrix.txt');
q1=matrix(:,1);
for i=1:(length(matrix(1,:)))/2-1
    real(:,i)=matrix(:,2*i+1);ima(:,i)=matrix(:,2*i+2);
end

figure(1),plot((real)) 
figure(2),plot(ima)
figure(3),plot(real.^2 + ima.^2) 
%for i=1:101
%    figure(3),plot(real(:,i).^2 + ima(:,i).^2), hold on,pause
%end

hpsi=load('hpsi.txt');
psic=load('psic.txt');

soma1=0;soma2=0;
for i=1:61
    xxx(i,1)= (psic(i,1)*hpsi(i,1)) - (psic(i,2)*hpsi(i,2));
    xxx(i,2)= (psic(i,1)*hpsi(i,2)) + (psic(i,2)*hpsi(i,1));
    soma1=soma1+xxx(i,1);
    soma2=soma1+xxx(i,2);
end

%break

x=load('test.txt');
figure(4),plot(x)

%for i=1:length(real)
%plot(real(i),ima(i)),hold on%,pause
%end


aa=[     -0.0000001262382457    -0.0000000477391169
    -0.0000003995060074    -0.0000000997891841
    -0.0000011998454581    -0.0000001544265998
    -0.0000034219286532    -0.0000000384315509
    -0.0000092695463703     0.0000009819634521
    -0.0000238463321795     0.0000053904218497
    -0.0000582266590473     0.0000205368736636
    -0.0001348095723610     0.0000660966115676
    -0.0002954767159846     0.0001904876857196
    -0.0006116142371194     0.0005041674678972
    -0.0011912273538000     0.0012417677832482
    -0.0021707579422444     0.0028682299305627
    -0.0036669933416424     0.0062430036465593
    -0.0056490468996550     0.0128454444672777
    -0.0076776458122318     0.0250374460544020
    -0.0084607670355524     0.0462925661949934
    -0.0052078060669637     0.0812597462955513
     0.0071556862118282     0.1354745658274506
     0.0367224478693723     0.2145191399179572
     0.0949471798885102     0.3225089805819688
     0.1961521535793598     0.4599831830854360
     0.3557732399759632     0.6215794640655316
     0.5871652329064836     0.7942034601780191
     0.8972563614106142     0.9566008462059552
     1.2819437950159536     1.0811419097243289
     1.7226323307396747     1.1381325069804353
     2.1854573045560981     1.1021349490851629
     2.6242921866311946     0.9588744158212140
     2.9876252507687013     0.7107056860151287
     3.2280807729262984     0.3786696401319146
     3.3122497036679213     0.0000000000000000
     3.2280807729262984    -0.3786696401319146
     2.9876252507687013    -0.7107056860151287
     2.6242921866311946    -0.9588744158212140
     2.1854573045560981    -1.1021349490851629
     1.7226323307396747    -1.1381325069804353
     1.2819437950159536    -1.0811419097243289
     0.8972563614106142    -0.9566008462059552
     0.5871652329064836    -0.7942034601780191
     0.3557732399759632    -0.6215794640655316
     0.1961521535793598    -0.4599831830854360
     0.0949471798885119    -0.3225089805819715
     0.0367224478693723    -0.2145191399179572
     0.0071556862118282    -0.1354745658274506
    -0.0052078060669637    -0.0812597462955513
    -0.0084607670355524    -0.0462925661949934
    -0.0076776458122317    -0.0250374460544017
    -0.0056490468996550    -0.0128454444672777
    -0.0036669933416424    -0.0062430036465592
    -0.0021707579422444    -0.0028682299305627
    -0.0011912273538000    -0.0012417677832482
    -0.0006116142371194    -0.0005041674678972
    -0.0002954767159846    -0.0001904876857196
    -0.0001348095723610    -0.0000660966115676
    -0.0000582266590473    -0.0000205368736636
    -0.0000238463321795    -0.0000053904218497
    -0.0000092695463703    -0.0000009819634521
    -0.0000034219286532     0.0000000384315509
    -0.0000011998454581     0.0000001544265998
    -0.0000003995060074     0.0000000997891841
    -0.0000001262382457     0.0000000477391169];a=complex(aa(:,1),aa(:,2));
 
 bb=[    -0.0000001262382457    -0.0000000477391169
    -0.0000003995060074    -0.0000000997891841
    -0.0000011998454581    -0.0000001544265998
    -0.0000034219286532    -0.0000000384315509
    -0.0000092695463703     0.0000009819634521
    -0.0000238463321795     0.0000053904218497
    -0.0000582266590473     0.0000205368736636
    -0.0001348095723610     0.0000660966115676
    -0.0002954767159846     0.0001904876857196
    -0.0006116142371194     0.0005041674678972
    -0.0011912273538000     0.0012417677832482
    -0.0021707579422444     0.0028682299305627
    -0.0036669933416424     0.0062430036465593
    -0.0056490468996550     0.0128454444672777
    -0.0076776458122318     0.0250374460544020
    -0.0084607670355524     0.0462925661949934
    -0.0052078060669637     0.0812597462955513
     0.0071556862118282     0.1354745658274506
     0.0367224478693723     0.2145191399179572
     0.0949471798885102     0.3225089805819688
     0.1961521535793598     0.4599831830854360
     0.3557732399759632     0.6215794640655316
     0.5871652329064836     0.7942034601780191
     0.8972563614106142     0.9566008462059552
     1.2819437950159536     1.0811419097243289
     1.7226323307396747     1.1381325069804353
     2.1854573045560981     1.1021349490851629
     2.6242921866311946     0.9588744158212140
     2.9876252507687013     0.7107056860151287
     3.2280807729262984     0.3786696401319146
     3.3122497036679213     0.0000000000000000
     3.2280807729262984    -0.3786696401319146
     2.9876252507687013    -0.7107056860151287
     2.6242921866311946    -0.9588744158212140
     2.1854573045560981    -1.1021349490851629
     1.7226323307396747    -1.1381325069804353
     1.2819437950159536    -1.0811419097243289
     0.8972563614106142    -0.9566008462059552
     0.5871652329064836    -0.7942034601780191
     0.3557732399759632    -0.6215794640655316
     0.1961521535793598    -0.4599831830854360
     0.0949471798885119    -0.3225089805819715
     0.0367224478693723    -0.2145191399179572
     0.0071556862118282    -0.1354745658274506
    -0.0052078060669637    -0.0812597462955513
    -0.0084607670355524    -0.0462925661949934
    -0.0076776458122317    -0.0250374460544017
    -0.0056490468996550    -0.0128454444672777
    -0.0036669933416424    -0.0062430036465592
    -0.0021707579422444    -0.0028682299305627
    -0.0011912273538000    -0.0012417677832482
    -0.0006116142371194    -0.0005041674678972
    -0.0002954767159846    -0.0001904876857196
    -0.0001348095723610    -0.0000660966115676
    -0.0000582266590473    -0.0000205368736636
    -0.0000238463321795    -0.0000053904218497
    -0.0000092695463703    -0.0000009819634521
    -0.0000034219286532     0.0000000384315509
    -0.0000011998454581     0.0000001544265998
    -0.0000003995060074     0.0000000997891841
    -0.0000001262382457     0.0000000477391169];b=complex(bb(:,1),bb(:,2));

cc=[-0.0000000003449821    -0.0000000000396927
    -0.0000000015603538    -0.0000000000178164
    -0.0000000042003831    -0.0000000006064100
    -0.0000000107585544    -0.0000000029990150
    -0.0000000259732885    -0.0000000110174656
    -0.0000000589614720    -0.0000000346641370
    -0.0000001253912873    -0.0000000979048911
    -0.0000002483762079    -0.0000002535334516
    -0.0000004539451394    -0.0000006086347709
    -0.0000007529124432    -0.0000013628000685
    -0.0000010962208344    -0.0000028558057228
    -0.0000012882545490    -0.0000056095950513
    -0.0000008479142189    -0.0000103305456982
     0.0000011719573830    -0.0000178166390907
     0.0000063543476797    -0.0000287029538593
     0.0000169657926215    -0.0000429987666378
     0.0000357174785196    -0.0000594422518396
     0.0000650708862436    -0.0000748304528832
     0.0001060164381741    -0.0000836421079796
     0.0001564822192048    -0.0000783794904731
     0.0002098536559700    -0.0000510006084812
     0.0002543742390952     0.0000044940923626
     0.0002742508663267     0.0000888012617287
     0.0002529246376700     0.0001944658500062
     0.0001781647981593     0.0003048751344006
     0.0000476346857164     0.0003962894393673
    -0.0001271681047725     0.0004431625661552
    -0.0003206752118495     0.0004256068663755
    -0.0004977650223081     0.0003365984017630
    -0.0006223031317005     0.0001860894158464
    -0.0006671702906527     0.0000000000000000
    -0.0006223031317005    -0.0001860894158464
    -0.0004977650223081    -0.0003365984017630
    -0.0003206752118495    -0.0004256068663755
    -0.0001271681047725    -0.0004431625661552
     0.0000476346857164    -0.0003962894393673
     0.0001781647981593    -0.0003048751344006
     0.0002529246376700    -0.0001944658500062
     0.0002742508663267    -0.0000888012617287
     0.0002543742390952    -0.0000044940923626
     0.0002098536559700     0.0000510006084812
     0.0001564822192048     0.0000783794904731
     0.0001060164381741     0.0000836421079796
     0.0000650708862436     0.0000748304528832
     0.0000357174785196     0.0000594422518396
     0.0000169657926215     0.0000429987666378
     0.0000063543476797     0.0000287029538593
     0.0000011719573830     0.0000178166390907
    -0.0000008479142189     0.0000103305456982
    -0.0000012882545490     0.0000056095950513
    -0.0000010962208344     0.0000028558057228
    -0.0000007529124432     0.0000013628000685
    -0.0000004539451394     0.0000006086347709
    -0.0000002483762079     0.0000002535334516
    -0.0000001253912873     0.0000000979048911
    -0.0000000589614720     0.0000000346641370
    -0.0000000259732885     0.0000000110174656
    -0.0000000107585544     0.0000000029990150
    -0.0000000042003831     0.0000000006064100
    -0.0000000015603538     0.0000000000178164
    -0.0000000003449821     0.0000000000396927];c=complex(cc(:,1),cc(:,2));
    
dd=[    -0.0000000003449821    -0.0000000000396927
    -0.0000000015603538    -0.0000000000178164
    -0.0000000042003831    -0.0000000006064100
    -0.0000000107585544    -0.0000000029990150
    -0.0000000259732885    -0.0000000110174656
    -0.0000000589614720    -0.0000000346641370
    -0.0000001253912873    -0.0000000979048911
    -0.0000002483762079    -0.0000002535334516
    -0.0000004539451394    -0.0000006086347709
    -0.0000007529124432    -0.0000013628000685
    -0.0000010962208344    -0.0000028558057228
    -0.0000012882545490    -0.0000056095950513
    -0.0000008479142189    -0.0000103305456982
     0.0000011719573830    -0.0000178166390907
     0.0000063543476797    -0.0000287029538593
     0.0000169657926215    -0.0000429987666378
     0.0000357174785196    -0.0000594422518396
     0.0000650708862436    -0.0000748304528832
     0.0001060164381741    -0.0000836421079796
     0.0001564822192048    -0.0000783794904731
     0.0002098536559700    -0.0000510006084812
     0.0002543742390952     0.0000044940923626
     0.0002742508663267     0.0000888012617287
     0.0002529246376700     0.0001944658500062
     0.0001781647981593     0.0003048751344006
     0.0000476346857164     0.0003962894393673
    -0.0001271681047725     0.0004431625661552
    -0.0003206752118495     0.0004256068663755
    -0.0004977650223081     0.0003365984017630
    -0.0006223031317005     0.0001860894158464
    -0.0006671702906527     0.0000000000000000
    -0.0006223031317005    -0.0001860894158464
    -0.0004977650223081    -0.0003365984017630
    -0.0003206752118495    -0.0004256068663755
    -0.0001271681047725    -0.0004431625661552
     0.0000476346857164    -0.0003962894393673
     0.0001781647981593    -0.0003048751344006
     0.0002529246376700    -0.0001944658500062
     0.0002742508663267    -0.0000888012617287
     0.0002543742390952    -0.0000044940923626
     0.0002098536559700     0.0000510006084812
     0.0001564822192048     0.0000783794904731
     0.0001060164381741     0.0000836421079796
     0.0000650708862436     0.0000748304528832
     0.0000357174785196     0.0000594422518396
     0.0000169657926215     0.0000429987666378
     0.0000063543476797     0.0000287029538593
     0.0000011719573830     0.0000178166390907
    -0.0000008479142189     0.0000103305456982
    -0.0000012882545490     0.0000056095950513
    -0.0000010962208344     0.0000028558057228
    -0.0000007529124432     0.0000013628000685
    -0.0000004539451394     0.0000006086347709
    -0.0000002483762079     0.0000002535334516
    -0.0000001253912873     0.0000000979048911
    -0.0000000589614720     0.0000000346641370
    -0.0000000259732885     0.0000000110174656
    -0.0000000107585544     0.0000000029990150
    -0.0000000042003831     0.0000000006064100
    -0.0000000015603538     0.0000000000178164
    -0.0000000003449821     0.0000000000396927];d=complex(dd(:,1),dd(:,2));
    
vec=0.0d0;
for i=1:length(a)
    vec= vec +  bb(i,1)*dd(i,1) - bb(i,2)*dd(i,2);
end

